---
title: hexoåšå®¢è¿ç§»
date: 2022-05-08 13:34:20
tags:
- hexo
- åšå®¢
- CDN
- GithubAction
categories:
- Linux
cover: ../../static/blog.jpg
---

## ç›®çš„

äº”å…­å¹´å‰ä¹°çš„è…¾è®¯äº‘å­¦ç”Ÿæœºï¼Œç³»ç»Ÿå¤ªè¿‡è€æ—§ï¼Œç›®å‰æ­£åœ¨é€æ­¥æ‰§è¡Œè¿ç§»è®¡åˆ’ï¼Œé¦–å½“å…¶å†²çš„å°±æ˜¯æ‰˜ç®¡äºæœåŠ¡å™¨ä¸Šçš„é™æ€é¡µé¢ï¼Œä»¥åŠå¶æœ‰è®¿é—®çš„åšå®¢ç³»ç»Ÿï¼Œæœ€å¥½åšåˆ°**ä¸åœæœºä¸å˜ URL çš„è¿ç§»**ï¼Œä¹Ÿæ˜¯å¯¹è‡ªå·±æŠ€æœ¯çš„ä¸€ä¸ªæ£€éªŒã€‚

## ç°çŠ¶

ä¹‹å‰è®°å½•åšå®¢ä½¿ç”¨çš„æ˜¯ Wordpressï¼Œå½“æ—¶éå¸¸å–œæ¬¢é‡Œè¾¹**å®Œå–„çš„åŠŸèƒ½ä»¥åŠä¸°å¯Œçš„ä¸»é¢˜**ï¼Œæ’ä»¶å’Œç•Œé¢è°ƒæ•´ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚

![](../static/assets/2022-05-08-14-10-52-image.png)

![](../static/assets/2022-05-08-14-30-51-image.png)

ä½†ç”¨çš„æ—¶é—´è¶Šä¹…ï¼Œå°±è¶Šå‘è§‰**åºå¤§ä¸”è¿è¡Œç¼“æ…¢**ï¼Œé‡Œè¾¹çš„ markdown æ’ä»¶ä½“éªŒä¸ä½³ï¼Œæ¯æ¬¡åœ¨æ…¢ååè¿›å…¥ç³»ç»Ÿåï¼Œè¿˜éœ€è¦å¿å—æ¯”è¾ƒç³Ÿç³•çš„ç¼–å†™ä½“éªŒï¼ˆæ²¡æœ‰å®æ—¶é¢„è§ˆï¼Œçº¯æ‰‹å†™ markdownï¼‰ï¼Œæ¯”è¾ƒæ‰“å‡»å†™æ–‡ç§¯ææ€§ï¼ˆå’•å’•å’•å€Ÿå£+1ï¼‰

![](../static/assets/2022-05-08-14-32-54-image.png)

ä¸€æ®µæ—¶é—´ä¸è¿›å…¥ç³»ç»Ÿè¿˜ä¼šæœ‰å¾ˆå¤š**æœºå™¨äººå‘çš„ä¹±ä¸ƒå…«ç³Ÿçš„åƒåœ¾è¯„è®º**å‡ºç°åœ¨åå°ç­‰å¾…å®¡æ ¸ï¼Œä¸€æ˜¯æœ‰å®‰å…¨æ€§ä¸Šçš„æ‹…å¿§ï¼Œä¸‡ä¸€æœ‰äººæä¸€ä¸ª XSSï¼Œæˆ‘åœ¨å®¡æ ¸è¯„è®ºæ—¶ä¸­æ‹›äº†ä¸å°±å±é™©äº†ï¼›äºŒæ¥è¯„è®ºå®¡æ ¸å’Œè¿‡æ»¤ä¹Ÿéå¸¸çš„æ…¢ï¼Œå¤„ç†å®Œè¿™äº›äº‹æƒ…ï¼Œå†™æ–‡ç§¯ææ€§åˆé™ä½äº†ä¸€æˆã€‚

![](../static/assets/2022-05-08-14-33-46-image.png)

å¹¶ä¸”æˆ‘å¥³æœ‹å‹çš„åšå®¢ä¹Ÿåœ¨ä¸Šé¢ï¼Œ[https://lhx.blog.wj2015.com/](https://lhx.blog.wj2015.com/)ï¼Œç”¨ Wordpress çš„å¤šç«™ç‚¹åšçš„ï¼Œä¸æˆ‘ä¸€æ ·ï¼Œæ¯æ¬¡ç™»é™†è‡³å°‘å‡ åˆ†é’Ÿçš„ç²¾åŠ›è€—åœ¨ä¸æ— å…³çš„äº‹æƒ…ä¸Šï¼Œç”šè‡³å¤ªä¹…æ²¡ç™»è¿˜éœ€è¦æ‰¾å›å¯†ç ã€‚

äºæ˜¯ï¼Œå€Ÿä¸ªäººæœåŠ¡å™¨å‡çº§çš„ä¸œé£ï¼Œç¿»æŸ¥äº†ç°æœ‰çš„åšå®¢æ–¹æ¡ˆï¼Œå‘ç°å°†åšå®¢å…¨éƒ¨é™æ€åŒ–å¯èƒ½æ›´ç¬¦åˆæˆ‘ç°åœ¨çš„è°ƒæ€§ï¼Œè¯„è®ºç­‰éœ€æ±‚ç”¨ gitlk ç­‰ä¸‰æ–¹æœåŠ¡å³å¯ï¼Œæ— éœ€å¦è¡Œæ“å¿ƒã€‚

## æ•ˆæœ

è¿™é‡Œç”¨äº† [GitHub - theme-nexmoe/hexo-theme-nexmoe: ğŸ”¥ ä¸€ä¸ªæ¯”è¾ƒç‰¹åˆ«çš„ Hexo ä¸»é¢˜](https://github.com/theme-nexmoe/hexo-theme-nexmoe) ä¸»é¢˜ï¼Œç¨ä½œä¿®æ”¹å°±æˆäº†ç°åœ¨çš„æ¨¡æ ·ã€‚

> PSï¼šä»¥åå¯èƒ½ä¼šå˜åŒ–ï¼Œæ‰€ä»¥å…ˆç•™ä¸ªæ¡£è®°å½•ä¸‹åˆå§‹çŠ¶å†µ

![](../static/assets/2022-05-08-15-48-44-image.png)

![](../static/assets/2022-05-08-15-49-09-image.png)

![](../static/assets/2022-05-08-15-49-20-image.png)

## è°ƒç ”

å€ŸåŠ©ç™¾åº¦å¨˜è°·æ­Œå¨˜ï¼Œä»¥åŠä¸‡èƒ½çš„ githubï¼Œæˆ‘å¤§æ¦‚çœ‹äº†ä¸‰æ¬¾é™æ€åšå®¢ç”Ÿæˆå™¨

è¿˜æœ‰ä¸€ä¸ªé¡¹ç›®å¯¹è¿™ç±»é™æ€ç½‘ç«™ç”Ÿæˆå™¨åšäº†æ•´ç†ï¼Œå¯å¤ªå¤šäº†ï¼Œ[GitHub - pinceladasdaweb/Static-Site-Generators: A definitive list of tools for generating static websites.](https://github.com/pinceladasdaweb/Static-Site-Generators)

- Hexoï¼šhttps://hexo.io/zh-cn/index.html

- Jekyllï¼šhttps://jekyllrb.com/

- Hugoï¼šhttps://www.gohugo.org/

æœ€åè¿˜æ˜¯ hexo å¸å¼•ä½äº†æˆ‘ï¼Œç†ç”±æœ‰ä¸‰

- ç¨‹åºæ˜¯ nodejs å†™çš„ï¼Œ**æ’ä»¶ç”Ÿæ€æ¯”è¾ƒå¤š**ï¼Œæˆ‘ä¹Ÿæ¯”è¾ƒç†Ÿæ‚‰ Nodejsï¼Œæœ‰äº›é—®é¢˜æ–‡æ¡£æè¿°ä¸æ¸…å¯ä»¥çœ‹æºç äº†è§£ï¼Œä¸€èˆ¬ nodejs ç¤¾åŒºé«˜çº§å‰ç«¯æ¯”è¾ƒå¤šï¼Œä¸»é¢˜äº§å‡ºè´¨é‡åº”è¯¥ä¹Ÿé«˜ä¸€ç‚¹å§ï¼›

- **å·²æœ‰ä¸å°‘ä¸»é¢˜æ¯”è¾ƒå¥½çœ‹ä¸”åˆ‡æ¢ä¾¿åˆ©**ï¼Œåˆ©ç”¨æ’ä»¶å®Œå…¨å¯ä»¥ç”¨ markdown ç¼–è¾‘å™¨é¢„è§ˆå’Œç¼–å†™æ–‡ç« ï¼Œå†é€šè¿‡è„šæœ¬æˆ– CI/CD ä¸€é”®å‘å¸ƒ

- æœ‰ä¸€ä¸ªä» wordpress è¿ç§»åˆ° hexo çš„æ–¹æ¡ˆï¼Œè¿™ä¸ªæ¯”è¾ƒé‡è¦

## å®è·µ

### æ•°æ®è¿ç§»å’Œé—®é¢˜å¤„ç†

ä» Wordpres è¿ç§»åˆ° hexoï¼Œæœ‰è¿™ä¹ˆä¸€ä¸ªæ’ä»¶ [GitHub - hexojs/hexo-migrator-wordpress: WordPress migrator for Hexo.](https://github.com/hexojs/hexo-migrator-wordpress)

å®‰è£…å®Œæ¯•ååœ¨æºç«™çš„ã€å·¥å…·ã€->ã€å¯¼å‡ºã€ä¸­å¯¼å‡ºæ‰€æœ‰å†…å®¹

![](../static/assets/2022-05-08-15-15-28-image.png)

å†æ‰§è¡Œè¿›å…¥ hexo é¡¹ç›®ä¸­ï¼Œå®‰è£…æ­¤æ’ä»¶

```bash
npm i hexo-migrator-wordpress -D
```

å°†å¯¼å‡ºçš„ `wordpress.xml` æ”¾å…¥è¿›å»

```bash
hexo migrate wordpress ./wordpress.xml --skipduplicate --import_image
```

#### ç¢°åˆ°çš„é—®é¢˜

##### å›¾ç‰‡æ²¡æœ‰é»˜è®¤å¯¼å…¥

ä¼°è®¡ä¹Ÿæ˜¯è¿ç§»æ’ä»¶åŠŸèƒ½ä¸å®Œå–„å¯¼è‡´çš„ï¼Œä½†å¥½åœ¨ Wordpress æ‰€æœ‰çš„ä¸Šä¼ æ–‡ä»¶éƒ½åœ¨ `uploads` ç›®å½•ä¸­ï¼Œå¤šç«™ç‚¹æ¨¡å¼ä¸‹è¿˜ä¼šæœ‰ `uploads/sites/{id}/` çš„å­ç›®å½•ï¼Œæˆ‘æŠŠæ‰€æœ‰çš„å›¾ç‰‡æ‰“åŒ…ä¸‹è½½ä¸‹æ¥åï¼Œåšäº†ä¸‹æ‰¹é‡æ›¿æ¢ **ï¼ˆè¿™é‡Œè®°å¾—æ£€æŸ¥ zip åŒ…çš„ md5ï¼Œå¦åˆ™å¯èƒ½è§£å‹å¤±è´¥æˆ–å›¾ç‰‡ä¸¢å¤±ï¼‰**ï¼Œ**å°†è·¯å¾„æ¢ä¸ºæœ¬åœ°ç›¸å¯¹è·¯å¾„å³å¯**

ç”¨ç›¸å¯¹è·¯å¾„çš„å¥½å¤„åœ¨äºï¼š

- Markdown ç¼–è¾‘å™¨ä¸€èˆ¬éƒ½æ”¯æŒå°†å›¾ç‰‡ä¼ åˆ°å›ºå®šè·¯å¾„ï¼Œå¹¶ä¼˜å…ˆä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œç¼–è¾‘æ—¶ä½“éªŒç›¸å¯¹å‹å¥½

- åšå®¢é¡¹ç›®å’Œèµ„æºå­˜åœ¨äºä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæ–¹ä¾¿æŸ¥çœ‹å’Œç»´æŠ¤

- æœ¬åœ°ç¼–è¾‘æ—¶æ›´é¡ºç•…ï¼Œä¸å¿…ä¾èµ–ç½‘ç»œ

ä½†ä¹Ÿå¸¦æ¥äº†åå¤„ï¼Œæ˜¯ä¸ªå¤§å‘ï¼š

- ç”±äºåšå®¢è·¯å¾„éœ€è¦ä¸ wordpress ä¿æŒä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯ `:year/:month/:day/:title/` æ ¼å¼çš„é“¾æ¥åœ°å€ï¼Œç›¸å¯¹è·¯å¾„ä¸èƒ½ç›´æ¥æ¸²æŸ“ï¼Œ**å¿…é¡»åœ¨ç¨‹åºä¸Šè½¬æ¢ä¸º CDN åœ°å€æˆ–ç»å¯¹åœ°å€**

**å¦‚æœæœ‰è‡ªå·±ç¨³å®šä½¿ç”¨çš„å›¾åºŠï¼Œé‚£ä¹ˆç”¨ picgo ç­‰è½¯ä»¶ä¸Šä¼ å®Œæ¯•åç›´æ¥ç²˜è´´å›¾ç‰‡åœ°å€ï¼Œä¼šæ›´ç®€å•è½»æ¾**ï¼Œä½†å›¾åºŠè‡ªèº«çš„ç»´æŠ¤æˆæœ¬åŠæ—¥åè¿ç§»çš„æˆæœ¬ã€ä»¥åŠæœ¬åœ°é¢„è§ˆæ—¶ä¸€å®šéœ€è¦ä»ç½‘ç»œä¸Šä¸‹è½½å›¾ç‰‡ï¼Œä½“éªŒä¸Šä»¥åŠå¢åŠ çš„èµ„æºéƒ½æ˜¯ä»£ä»·ã€‚

æ‰€ä»¥ä»»ä½•æ–¹æ¡ˆéƒ½æœ‰ä»£ä»·çš„ï¼Œé€‰æ‹©äº†å…¶ä¸­ä¸€æ¡é“è·¯ï¼Œäº«å—äº†å¥½å¤„ï¼Œå°±éœ€è¦è§£å†³ä»–å¸¦æ¥çš„é—®é¢˜ã€‚

##### åšå®¢æ²¡æœ‰å°é¢

å› ä¸º hexo é»˜è®¤çš„ post å±æ€§æ˜¯ä¸å¸¦å°é¢çš„ï¼Œwordpress ä¸­å°é¢ä¹Ÿå¹¶éå¿…å¡«

- è§£å†³æ–¹æ³•ï¼šæŠŠå¿…è¦çš„åšå®¢ cover æ‰‹åŠ¨å¡«è¡¥ä¸Šå³å¯

##### åˆ†ç±»ç´Šä¹±

è¿™ä¸ªçœ‹ä¸»é¢˜æ˜¯å¦‚ä½•å¤„ç†åˆ†ç±»çš„ï¼ŒWordpress ä¸­åˆ†ç±»æ˜¯å¯ä»¥æœ‰çˆ¶çº§ç»“æ„çš„ï¼Œhexo ä¹Ÿæ”¯æŒçˆ¶å­åˆ†ç±»ï¼Œä½†æ’ä»¶å¦‚æœä¸åšåŒºåˆ†å’Œé…ç½®å…¨éƒ¨è¾“å‡ºå‡ºæ¥ï¼Œæ•ˆæœå°±ä¸ä¼šå¤ªå¥½çœ‹

- è§£å†³æ–¹æ³•ï¼šé€šè¿‡æŸ¥æ‰¾å’Œæ›¿æ¢ï¼Œæ•´ç†å¥½ä¸è§„èŒƒå’Œè¿‡å¤šçš„å­åˆ†ç±»

##### è¡¨æ ¼å¯¼å…¥ä¸æ­£ç¡®

å¯¼å…¥çš„è¡¨æ ¼ä¼šä¸¢å¤±æ ¼å¼ï¼Œåƒä¸‹é¢è¿™æ ·

![](../static/assets/2022-05-08-15-17-52-image.png)

ç›®å‰æ²¡å‘ç°å¥½çš„è§£å†³åŠæ³•ï¼Œæˆ‘å¹³æ—¶ Markdown è¡¨æ ¼ç”¨çš„ä¸å¤šï¼Œåªèƒ½è‡ªå·±æ‰‹åŠ¨ç¼–è¾‘æ”¹è¿‡æ¥äº†

![](../static/assets/2022-05-08-15-20-47-image.png)

##### CDN é—®é¢˜

éƒ¨åˆ†ä¸»é¢˜å–œæ¬¢ä½¿ç”¨ jsdrivrï¼Œè¿™ä¸ª CDN å…è´¹ä¸”åœ¨å›½å¤–é€Ÿåº¦é£å¿«ï¼Œç¼ºç‚¹å°±æ˜¯å›½å†…å¾ˆæ…¢ã€‚ç”±äºæˆ‘é€‰æ‹©äº†å›¾ç‰‡ç›¸å¯¹è·¯å¾„è¿™æ¡è·¯ï¼Œä»¥åŠ Wordpress è¿ç§»è¿‡æ¥çš„ç‰¹æ®Šæ€§ï¼Œä½¿ç”¨äº†å¸‚é¢ä¸Šå„å¼å„æ ·çš„å›¾ç‰‡å¤„ç†æ’ä»¶éƒ½æ— æ³•æ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚

äºæ˜¯ä¹ï¼Œæˆ‘å‚è€ƒäº†å›½äººåŒèƒå†™çš„ï¼Œ[GitHub - JoeyBling/hexo-filter-image: è‡ªåŠ¨ä¸ºhexoä¸­çš„å›¾ç‰‡æ˜ å°„ç»å¯¹è·¯å¾„ | Automatically maps absolute paths to images in hexo](https://github.com/JoeyBling/hexo-filter-image) æ’ä»¶ï¼Œè‡ªå·±å†™äº†ä¸€ä¸ª `scripts/images.js`

é€šè¿‡ `_config.yml` ä¸­çš„ `imageRoot` å‚æ•°æ¥æ§åˆ¶æ–‡ç« ä¸­æ‰€æœ‰å›¾ç‰‡çš„è®¿é—®è·¯å¾„

```yml
# æµé‡è´Ÿæ‹…ä¸èµ·çš„æ—¶å€™ï¼Œå†ç”¨è¿™ä¸ªå§
# imageRoot: https://cdn.jsdelivr.net/gh/wangerzi/blog@latest/source/
imageRoot: /
```

å¦‚æœåé¢æˆ‘å‘ç°ç›´æ¥ç”¨è…¾è®¯äº‘ CDN å›¾ç‰‡åŠ è½½ç€å®æ…¢ï¼Œæ”¹ä¸€ä¸ªé…ç½®å³å¯ï¼Œè„šæœ¬çš„åŸç†æ˜¯**æ¯æ¬¡æ¸²æŸ“åå°† img src ä¸­æ»¡è¶³ç›¸å¯¹è·¯å¾„æ¡ä»¶çš„ img æå–å‡ºæ¥ï¼Œæ ¹æ® markdown çš„è·¯å¾„ï¼Œè®¡ç®—å‡ºå›¾ç‰‡ç›¸å¯¹ sourcePath çš„ç»å¯¹è·¯å¾„ï¼Œæœ€åæ‹¼æ¥ä¸Š imageRoot å³å¯**ï¼Œæ ¹æ® hexo çš„è§„åˆ™ï¼Œå°±å¯ä»¥é¡ºåˆ©çš„è®¿é—®åˆ°ç›¸å…³èµ„æºäº†ã€‚

```js
const path = require('path')
const cheerio = require('cheerio');
const imageRoot = hexo.config.imageRoot || '/';
const sourcePath = hexo.config.source_dir;

function convertRoot(docAbsPath, relSrc, sourcePath='') {
    const dirname = path.dirname(docAbsPath)
    const srcPath = path.normalize(path.resolve(dirname, relSrc));

    return path.relative(sourcePath, srcPath).replace(/\\/g, '/')
}

function urlForHelper(path = '/', docPath = '') {
    path = path.replace('\\', '/');
    if (/http[s]*.*|\/\/.*/.test(path) ||
        /^\s+\//.test(path)) {
        return path
    }
    if (path[0] === '#' || path.startsWith('//')) {
        return path;
    }

    if (path.startsWith('/')) {
        path = path.slice(1)
    }

    path = convertRoot(docPath, path, sourcePath)
    // Prepend path
    path = imageRoot + path;

    // path.replace(/\/{2,}/g, '/');
    // return path.replace(/(\\|\/){2,}/g, '/');
    return path;
}
hexo.extend.filter.register('after_post_render', function (data) {
    const docPath = data.full_source
    if (!docPath.endsWith('.md')) {
        console.log('path break', data.asset_dir, data.full_source)
        return ;
    }
    // console.log('path', data.asset_dir, data.full_source)
    // console.log("excerpt === " + data.excerpt);
    // console.log("more === " + data.more);
    // console.log("content === " + data.content);
    if (data.cover) {
        data.cover = urlForHelper(data.cover, docPath)
    }
    const dispose = ['excerpt', 'more', 'content'];
    for (var i = 0; i < dispose.length; i++) {
        var key = dispose[i];

        if (!data[key]) {
            continue;
        }
        var $ = cheerio.load(data[key], {
            ignoreWhitespace: false,
            xmlMode: false,
            lowerCaseTags: false,
            decodeEntities: false
        });

        $('img').each(function () {
            var src = $(this).attr('src');
            if (src) {
                // For windows style path, we replace '\' to '/'.
                const newUrl = urlForHelper(src, docPath);
                // console.log('change', $(this).parent().attr('href'), src, newUrl, data.full_source);
                if (src !== newUrl) {
                    $(this).attr('src', newUrl);
                }
                // too slow!!!
                if (src.indexOf($(this).parent().attr('href')) !== -1) {
                    $(this).parent().attr('href', newUrl)
                }
            } else {
            }
        });
        data[key] = $.html();
    }
    // if (this.config.imagePrefix) {
    //     data.content = data.content.replace(
    //         new RegExp(themeCfg.imageCDN.origin, "gm"),
    //         themeCfg.imageCDN.to
    //     );
    // }
})

console.log('')
```

##### ä¸»é¢˜å†™æ­» CDN çš„é—®é¢˜

ç”¨çš„ä¸»é¢˜æœ‰ç¡¬ç¼–ç  jsdrivr çš„ CDN åœ°å€ï¼Œå›½å†…ç”¨æˆ·ä½“éªŒå¾ˆå·®ã€‚

![](https://user-images.githubusercontent.com/22190579/167250696-d5e5cefc-29cf-4ea9-a757-c775cf1a1d2b.png)

åœ¨ ISSUE ä¸‹ä¹Ÿæœ‰å…¶ä»–ç”¨æˆ·åé¦ˆè¿™ä¸ªé—®é¢˜ï¼Œäºæ˜¯ä¹å†™äº†ä¸€ä¸ªè„šæœ¬åœ¨æ¸²æŸ“å®Œæ¯•ååŠ¨æ€çš„æ›¿æ¢è¿™äº›ç¡¬ç¼–ç åœ°å€ï¼Œå…·ä½“ç”¨æ³•å’Œä»£ç éƒ½é™„åœ¨äº†è¿™ä¸ª ISSUE ä¸Šã€‚

[ä¼˜åŒ–è¢«ç¡¬ç¼–ç çš„å¯è¾¾æ€§ä¸ä½³çš„cdnåœ°å€ Â· Issue #184 Â· theme-nexmoe/hexo-theme-nexmoe Â· GitHub](https://github.com/theme-nexmoe/hexo-theme-nexmoe/issues/184)

##### ç½‘ç«™ç»Ÿè®¡åˆ†æ

æ—¢ç„¶çº¯é™æ€äº†ï¼Œé‚£ä¹ˆåˆ†æç»Ÿè®¡æ–¹é¢è‡ªç„¶ä¹Ÿåªèƒ½ç”¨ä¸‰æ–¹æœåŠ¡äº†ï¼Œè¿™é‡Œç”¨äº† **Google Analytics**ï¼Œæ³¨å†Œä¸€ä¸ªè°·æ­Œè´¦å·ï¼Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®ååœ¨ hexo ä¸­å¼•å…¥å³å¯ä½¿ç”¨ï¼Œè¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ã€‚

![](../static/assets/2022-05-08-15-39-02-image.png)

#### å¾…è§£å†³çš„é—®é¢˜

##### é™æ€èµ„æºå‹ç¼©é—®é¢˜

è¿™ä¸ªé—®é¢˜æ¯”è¾ƒå¤æ‚ï¼Œhexo ä¸­ html / js /css éƒ½æ²¡æœ‰ç»è¿‡å‹ç¼©ï¼Œ**ä»¥åŠæˆ‘ä»¬å¹³æ—¶ç”¨çš„å¾®ä¿¡/QQæˆªå›¾ä¿å­˜ç”Ÿæˆçš„å›¾è´¼æ‹‰å¤§ï¼Œç²˜è´´åˆ°é¡¹ç›®æˆ–å›¾åºŠå‰æœ¬èº«å°±éœ€è¦ç»è¿‡ä¸€æ¬¡å‹ç¼©ã€‚**

æ¯”å¦‚å¶å°”ä¸€ä¸ªå¾®ä¿¡ç”Ÿæˆçš„ 1080p å±å¹•çš„æˆªå›¾ï¼Œ4Må¤šï¼Œç®€å•å‹ç¼©ä¸€ä¸‹ 8k å¤šï¼Œè™½ç„¶ä¹Ÿå¾ˆå¤§ï¼Œä½†ç›¸å¯¹æ¥è¯´ä¸è‡³äºç‰¹åˆ«æ— æ³•æ¥å—ã€‚

è€Œä¸”è¿™ä¸ªé—®é¢˜è¿˜å¯èƒ½è·Ÿä½¿ç”¨çš„ä¸»é¢˜æœ‰å…³ï¼Œåœ¨è°ƒç ” [hexo-theme-keep](https://keep-docs.xpoet.cn/) æ—¶ï¼Œä½œè€…åœ¨æ–‡æ¡£ä¸­å†™é“å¯ä»¥ä½¿ç”¨ [hexo-all-minifier](https://github.com/chenzhutian/hexo-all-minifier) æ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶åœ¨ keep ä¸Šä½“éªŒè‰¯å¥½ï¼ˆ**ä½†å‹ç¼© PNG ä¼šå¯¼è‡´ CPU çˆ†æ‰**ï¼‰ï¼Œä½†å…¶ä»–ä¸»é¢˜ä¸Šå°±å¯èƒ½æœ‰å…¼å®¹æ€§é—®é¢˜ã€‚

ä¸Šè¿°æ’ä»¶ä¹Ÿæœ‰æ®µæ—¶é—´æ²¡æ›´æ–°äº†ï¼Œæ¯•ç«Ÿæ˜¯å¼€æºå…¨é æƒ…æ€€ï¼Œå¯ä»¥ç†è§£ã€‚

##### è¯„è®ºé—®é¢˜

ä¸€å¼€å§‹æ˜¯æ‰“ç®—ç”¨ gitlk è¿™ç±»è¯„è®ºç³»ç»Ÿçš„ï¼Œä½†å…¶**å›½å†…è¿æ¥ github è¿‡æ…¢çš„è¿æ¥é€Ÿåº¦å¯¹ä½“éªŒçš„å½±å“è®©æˆ‘è¿˜æ˜¯å…³é—­æ‰äº†è¿™ä¸ªåŠŸèƒ½**ï¼Œåé¢æœ‰æ›´åˆé€‚çš„ï¼Œæ›´æœ‰å¿…è¦çš„åœºæ™¯æ—¶ï¼Œå†è€ƒè™‘æ‰“å¼€ã€‚

æ‰¾ä¸»é¢˜çš„æ—¶å€™ï¼Œå‘ç° hexo-theme-yun ä¸»é¢˜çš„ä½œè€…ï¼Œå¯¹ä¸‰æ–¹è¯„è®ºç³»ç»Ÿåšäº†è¿™æ ·ä¸€ç•ªæ€»ç»“ï¼Œå¯ä¾›å‚è€ƒï¼šhttps://www.yunyoujun.cn/share/third-party-comment-system/

hexo-theme-yun ä¸»é¢˜é“¾æ¥ï¼š[GitHub - YunYouJun/hexo-theme-yun: â˜ï¸ A fast & light & lovely theme for Hexo. ä¸€ä¸ªå¯¹å¯çˆ±è‡ªä»¥ä¸ºæ˜¯çš„ Hexo ä¸»é¢˜ã€‚](https://github.com/YunYouJun/hexo-theme-yun)

##### å›½å†…å’Œå¢ƒå¤–è®¿é—®çš„é—®é¢˜

è™½ç„¶æˆ‘è¿™æ˜¯ä¸ªä¸­æ–‡åšå®¢ï¼Œä½†æˆ‘åœ¨è°·æ­Œä¸Šçš„ç»Ÿè®¡æŠ¥è¡¨ä¸Šå‘ç°ï¼Œæ¯å¤©è¿˜æ˜¯**æœ‰äººé€šè¿‡ google æœç´¢åˆ°æˆ‘çš„é¡µé¢å¹¶è®¿é—®çš„**ï¼Œè€Œæˆ‘ç”¨çš„ CDN æ˜¯è…¾è®¯äº‘ï¼Œåœ¨æˆ‘ä¸å¼€å›½å¤–æµé‡åŒ…æ—¶ï¼Œä»–ä»¬çš„è®¿é—®é€Ÿåº¦ä¼šç‰¹åˆ«æ…¢ï¼Œç”šè‡³æ…¢è¿‡ç›´æ¥è®¿é—® githubpages ã€‚

![](../static/assets/2022-05-08-15-37-50-image.png)

è¿™é‡Œå€’æ˜¯æœ‰ä¸€äº›è§£å†³åŠæ³•ï¼Œæ¯”å¦‚**åŠ¨æ€ DNSï¼Œåˆ†åŒºåŸŸè§£æä¸åŒçš„è®°å½•**ï¼Œä½†å—é™äºæˆ‘åœ¨æ•°å¹´å‰åœ¨è…¾è®¯äº‘ä¸Šè´­ä¹°å’Œä½¿ç”¨çš„åŸŸåï¼Œæ‰€ä»¥é‡Œè¾¹ä¸åƒ AWS å¯ä»¥åˆ†åŒºåŸŸåšä¸åŒçš„ CNAME è§£æï¼ˆæˆ–è€…è¿™åœ¨è…¾è®¯äº‘ä¸Šæ˜¯ä»˜è´¹æœåŠ¡ï¼‰ï¼Œå¯¹äºæˆ‘æ¥è¯´æš‚æ—¶ä¸ä¼šè€ƒè™‘ï¼Œéšåå†è§£å†³å§ï¼Œæ¯•ç«Ÿæœ‰æœ¬åœ°ç¼“å­˜ä¹‹åï¼Œä½“éªŒå°šå¯ã€‚

å†æ¯”å¦‚ element å®˜ç½‘é‚£æ ·ï¼Œæ£€æŸ¥æ˜¯å¦å›½å†…ç”¨æˆ·ï¼Œç»™åˆ°ä¸åŒçš„ç½‘å€ï¼Œè¯´æ¥è¯é•¿ï¼Œéšåå†æƒ³åŠæ³•è§£å†³ã€‚

### å¦‚ä½•éƒ¨ç½²

ä¹‹å‰çœ‹è¿‡ hexo-deployer-cos-cdn ä½œè€…å†™äº†ä¸€ç¯‡å¸–å­ï¼Œæ˜¯å°†æ‰€æœ‰å›¾ç‰‡å’Œç”Ÿæˆçš„èµ„æºæ”¾åœ¨ cos ä¸Šçš„ï¼Œhttps://www.lixl.cn/2020/020936412.html

æ’ä»¶åœ°å€ï¼š[GitHub - lxl80/hexo-deployer-cos-cdn: Hexoéƒ¨ç½²æ’ä»¶ï¼Œæ”¯æŒå°†é™æ€åšå®¢å‘å¸ƒåˆ°è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨ä¸­ï¼Œå¹¶åŒæ­¥åˆ·æ–°è¢«æ›´æ–°æ–‡ä»¶çš„CDNç¼“å­˜ã€‚](https://github.com/lxl80/hexo-deployer-cos-cdn)

å› ä¸ºæˆ‘åˆšå°†æˆ‘çš„å¼€æºæ’ä»¶æ’ä»¶æ–‡æ¡£ã€é™æ€åŒ–çš„é¡¹ç›®éƒ½æ”¾åˆ°äº†è…¾è®¯äº‘çš„ COS ä¸­ï¼Œæ‰€ä»¥æˆ‘ä¸€å¼€å§‹ä¹Ÿæ‰“ç®—ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œ**ä½†åæ¥åœ¨å°è¯• githubaction + netflix åï¼Œå‘ç°æ¨åˆ° github ä¸­éšåä»€ä¹ˆä¹Ÿä¸ç®¡æ›´çˆ½ä¸€ç‚¹**ï¼Œåæ­£éƒ½æ˜¯é™æ€èµ„æºï¼Œå…¶ä»–çš„è®© CDN è‡ªåŠ¨åŠ é€Ÿå¥½äº†ï¼Œè¿˜èƒ½çœå»æœªæ¥å›¾ç‰‡è¿‡å¤š COS æ”¶è´¹çš„é—®é¢˜ã€‚

##### GithubAction

æŒ‰ç…§å®˜æ–¹æ•™ç¨‹ï¼Œåšä¸€ä¸ª workflow å³å¯ï¼Œä¹Ÿå°±æ˜¯åœ¨ `.github/workflows/pages.yml` ä¸­å¡«å…¥å¦‚ä¸‹å†…å®¹ï¼Œç›®å½•æ²¡æœ‰è‡ªå·±å»ºå¥½å³å¯

> åŸç†æ˜¯æ‰§è¡Œ npm run build åï¼Œå°†äº§ç‰©æ¨é€åˆ° gh-pages åˆ†æ”¯ä¸Š

```yml
name: Pages

on:
  push:
    branches:
      - master  # default branch

jobs:
  pages:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Use Node.js 16.x
        uses: actions/setup-node@v2
        with:
          node-version: '16'
      - name: Cache NPM dependencies
        uses: actions/cache@v2
        with:
          path: node_modules
          key: ${{ runner.OS }}-npm-cache
          restore-keys: |
            ${{ runner.OS }}-npm-cache
      - name: Install Dependencies
        run: npm install
      - name: Build
        run: npm run build
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./public
```

ç„¶ååœ¨é¡¹ç›® Setting -> Actions -> General ä¸‹ï¼Œå…è®¸ action è¯»å†™ä»“åº“ï¼Œä¸ç„¶æ‰§è¡Œä¼šå¤±è´¥

![](../static/assets/2022-05-08-16-09-51-image.png)

æäº¤æ•°æ®å¹¶æ¨é€åï¼Œä¼šåœ¨ actions ç•Œé¢çœ‹åˆ°æ‰§è¡Œè®°å½•

![](../static/assets/2022-05-08-16-11-33-image.png)

å¹¶ä¸”èƒ½å¤Ÿæ‰¾åˆ°è‡ªåŠ¨åˆ›å»ºçš„åˆ†æ”¯ï¼Œç‚¹è¿›å»ä¹‹åä¼šå‘ç°å…¨éƒ½æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„é™æ€æ–‡ä»¶

![](../static/assets/2022-05-08-16-12-24-image.png)

##### GithubPage

é€‰ä¸€ä¸‹åˆ†æ”¯ä¿å­˜å°±è¡Œï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªå¯è®¿é—®åœ°å€äº†

![](../static/assets/2022-05-08-16-13-07-image.png)

##### Netlify

https://www.netlify.com/

è¿™ä¸ªæœåŠ¡å¯ä»¥ç»™åˆ°ä½ ä¸€ä¸ªå¸¦ CDN çš„åœ°å€ï¼Œæ€§èƒ½æ¯” githubpages ç¨å¾®å¥½ç‚¹ï¼Œä½†æ˜¯å›½å†…ä¾æ—§å¾ˆæ…¢ï¼Œå¦‚æœè¿™å·²ç»å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œç›´æ¥æŠŠè‡ªå·±çš„åŸŸå CNAME åˆ°ä»–ç”Ÿæˆå¥½çš„åŸŸåä¸Šå³å¯ã€‚

è¿™é‡Œæœ‰ç¯‡æ•™ç¨‹ï¼šhttps://kalasearch.cn/blog/gatsby-blog-setup-tutorial-with-netlify/

##### è…¾è®¯äº‘ CDN

ç•Œé¢æ“ä½œå»ºå¥½å³å¯ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„å¯èƒ½å°±æ˜¯ç¼“å­˜éƒ¨åˆ†ï¼Œå…¶å®æ˜¯å¯ä»¥åšåˆ°æ¯æ¬¡æ›´æ–°å°±åˆ·æ–°ç¼“å­˜çš„ï¼Œä½†ä»‹äºåšå®¢çš„åœºæ™¯ï¼Œæ–°å¢å¤šã€ä¿®æ”¹å°‘ï¼Œæ‰€ä»¥æˆ‘åšäº†å¦‚ä¸‹è§„åˆ™ï¼Œæ ¹è·¯å¾„ä¸‹çš„ `about.html/friends.html/archives.html` ç­‰é¡µé¢ä¼šéšç€æ–‡ç« ç¼–å†™è€Œå˜åŒ–ï¼Œè€Œé™æ€çš„å›¾ç‰‡å’Œ CSS/JS ç­‰èµ„æºåŸºæœ¬å°±ä¸å˜ï¼Œæ‰€ä»¥è®¾ç½®äº†èŠ‚ç‚¹7å¤©ç¼“å­˜çš„è§„åˆ™ï¼Œä¹Ÿè¶³å¤Ÿäº†ã€‚

![](../static/assets/2022-05-08-16-24-21-image.png)

è…¾è®¯äº‘çš„ HTTP2 æœ‰ç‚¹å‘ï¼Œå­˜åœ¨å¶ç°çš„å›¾ç‰‡æ— æ³•åŠ è½½çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘å…³æ‰äº†

å›æºæˆ‘é…ç½®çš„ netlify åœ°å€ï¼Œå› ä¸ºè…¾è®¯äº‘ä¸èƒ½æŒ‡å®šå›æºè·¯å¾„ï¼Œå¾®å‘ï¼Œåªèƒ½é€šè¿‡å›æºé…ç½®é‡Œçš„ URL é‡å†™æ¥æ›²çº¿æ•‘å›½ï¼Œä¸ç„¶ä¹Ÿå¯ä»¥å¤šé…ä¸€ä¸ª githubPages çš„é“¾æ¥ï¼Œä½†æˆ‘æ²¡æµ‹è¿‡ä¸¤è€…å›æºè°æ¯”è¾ƒå¿«![](../static/assets/2022-05-08-16-26-12-image.png)

ç­‰ CDN éƒ¨ç½²å®Œæ¯•ï¼Œä¿®æ”¹ DNS è§£æå°±å¯ä»¥å®ç°å¹³æ»‘çš„è¿ç§»

##### ç½‘ç»œç»“æ„

ä»ç”¨æˆ·åˆ°æœåŠ¡ï¼Œå¤§æ¦‚æ˜¯è¿™ä¹ˆä¸ªè¿‡ç¨‹

- DNS è§£æåˆ°è·ç¦»ç”¨æˆ·æœ€è¿‘çš„è…¾è®¯äº‘ CDN èŠ‚ç‚¹

- CDN èŠ‚ç‚¹æ˜¯å¦æœ‰ç¼“å­˜ä¸”æœªè¿‡æœŸ
  
  - æ˜¯ï¼šç›´æ¥è¿”å›æ•°æ®
  
  - å¦ï¼šå‘ netlify å›æº

- Netlify è¿™é‡Œä¼šç›‘æ§ github ä¸Š gh-page åˆ†æ”¯ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯æäº¤åå®æ—¶å˜åŒ–çš„

## åšå®¢ç¼–å†™æµç¨‹

ä¹‹å‰æ˜¯ç”¨ Typora çš„ï¼Œä½†æœ€è¿‘è¦æ”¶è´¹äº†ï¼Œäºæ˜¯ç›®æ ‡è½¬å‘äº†ä¸€ä¸ªå¼€æºçš„ç¼–è¾‘å™¨ MarkText

[GitHub - marktext/marktext: ğŸ“A simple and elegant markdown editor, available for Linux, macOS and Windows.](https://github.com/marktext/marktext)

è™½ç„¶ä¸æ”¯æŒä¸­æ–‡ï¼Œä½†æ˜¯æˆ‘æœ€å¸Œæœ›æœ‰çš„**å›¾ç‰‡ç›¸å¯¹è·¯å¾„ä¿å­˜**æ˜¯æœ‰çš„ï¼Œè¿™å°±è¶³å¤Ÿäº†ï¼Œé…ç½®å¦‚ä¸‹ï¼š

> ctrl + shift + O æ‰“å¼€é¡¹ç›®æ–‡ä»¶ï¼Œç„¶å global image foldr è®¾ä¸º sourcePathï¼Œrelative image folder è®¾ä¸ºç›¸å¯¹äºé¡¹ç›®çš„è·¯å¾„ï¼Œç„¶åç²˜è´´å›¾ç‰‡å°±ä¼šä¿å­˜è‡³æŒ‡å®šçš„ç›®å½•

![](../static/assets/2022-05-08-16-35-28-image.png)

æ•ˆæœï¼š

![](../static/assets/2022-05-09-10-41-57-image.png)

ç¼–å†™å®Œæ¯•åï¼Œ`npm run server`ï¼Œæœ¬åœ°é¢„è§ˆæ— è¯¯åï¼Œ`git commit`ã€`git push` å³å¯

## æ€»ç»“

é™æ€åŒ–çœ‹èµ·æ¥ç®€å•ï¼Œä½†ç»†èŠ‚ä¸Šè¿˜æ˜¯æœ‰å¾ˆå¤šé—®é¢˜çš„ï¼Œç‰¹åˆ«æ˜¯å›¾ç‰‡èµ„äº§ç®¡ç†ä¸Šï¼Œè·Ÿ CDN è®¿é—®å’Œè·¯ç”±æ··åœ¨ä¸€èµ·å°±æ¯”è¾ƒå¤æ‚ï¼Œç”šè‡³è¦è¾¾åˆ°æœ€å¥½çš„æ•ˆæœè¿˜éœ€è¦è‡ªå·±å†™ç‚¹ä»£ç ã€‚ 

è™½ç„¶ç¢°åˆ°äº†å¾ˆå¤šé—®é¢˜ï¼Œä½†è¿™ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯å¾ˆæœ‰è¶£ä¸”å¿«ä¹çš„ï¼Œä¹Ÿæ˜¯å¯¹è‡ªå·±æŠ€æœ¯ä¸Šçš„ä¸€æ¬¡ç»¼åˆæµ‹è¯•ã€‚
